# 开发日志

## 主要任务

1. 完成仿真环境搭建（地图+飞机模型）
2. 完成有限状态机的框架
3. 自主起飞与降落
4. 自主巡航
5. 识别位置解算
6. 俯冲精确打击

## 主要任务（7月9日）

1. 完成自主起飞
2. 自主巡航
3. 识别
4. 降落（可选

## 任务（7月19日）

(Saved)1、舵机驱动程序(ros自带的串口驱动程序)
2、非仿真环境下的飞行地理位置程序适配
3、头文件注释
4、识别程序耦合
5、文稿撰写

### ISSUE

1、飞机的速度有一定的下限，目前已知的仿真环境飞机的速度不低于10m/s。不清楚是否对识别有影响。。。

(Saved)2、盘旋半径过小会使得飞机的roll角过大，相机主轴与地面成角度过大，不适和作为飞机的识别模式。(直接低速飞过，不在盘旋下识别)

(Saved)3、飞机的idel模式的设置是否有必要性。。。(其实没有什么必要，直接takeoff-->detect-->task-->land)

(Saved)4、每次设置新的飞行任务是否需要切换Hold模式再切换回Mission模式(不需要手动切换模式，完成当前飞行任务时候自动切换，且可作为下一个认为的反馈)，是否会重置Frame = 6 下的相对海拔高度(相对海拔只与home点有关)。

(Saved)5、C++语言和python语言写出的代码是否有区别，需要验证。

6、试飞时地理位置需要重新配置.

(Saved)7、切换模式会进入死循环。（已将！=AUTO.MISSION修正为==AUTO.LOITER）

(Saved)8、没编译上？？

9、降落迎角过大

(Saved)10、识别区域过小（高度调高）

（Saved）11、经纬坐标设置麻烦（写了一个经纬坐标与当地坐标转换的类）

(Saved)12、检测程序设置成多线程并行吧

(Saved)13、打击程序也设置成多线程并行吧

(Saved){Major BUG}14、航点跳过！(必须现将航点清空再输入下一个航点)

(Paused)15、起落架舵机驱动接口

(Half Saved)16、打击物理数学方法结算（算法优化）(已完成第一版，待验证，待优化)
$$
V_x,V_y,V_z,X_{tar},Y_{tar},Z_{tar},X_{pose},Y_{pose},Z_{pose}
$$

$$
Define:Z_{tar} = 0,Z_{pose} = h
$$
$$
\begin{align}
    V_zt+\frac{1}{2}gt^2=h,g=9.8m/s\\
    ||X_{tar}-X_{pose}| - V_xt|<\delta\\
    ||Y_{tar} - X_{pose}| - V_yt|<\delta
\end{align}
$$

$$
t=\frac{-2V_z+\sqrt{4V_z^2+8gh}}{2g}
$$

16、识别接口耦合问题，通过文件耦合，没能识别，再次识别解决。

17、include头文件实现文件重新定向到include_dir中

(Saved)18、封装位置监听程序，在detec.cpp和task.cpp中复用。
